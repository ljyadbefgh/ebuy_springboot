webpackJsonp([11],{"3dzi":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={name:"CustomerManage",components:{CustomerAdd:function(){return o.e(36).then(o.bind(null,"blHB"))},CustomerEdit:function(){return o.e(38).then(o.bind(null,"Mki+"))},CustomerPhotoUpload:function(){return o.e(54).then(o.bind(null,"HQ0e"))},CustomerSearch:function(){return o.e(69).then(o.bind(null,"2HO5"))}},data:function(){return{disabled:!0,table:{tableData:[],limit:10,page:1,total:0,hideOnSinglePage:!1},multipleSelection:[],customerQuery:{username:null,name:null,sex:null,changeInitialPassword:"",uploadPhoto:null}}},methods:{getCustomers:function(){var t=this;this.$axios.get("/api/backstage/customermanage",{params:{page:this.table.page,limit:this.table.limit,username:this.customerQuery.username,name:this.customerQuery.name,sex:this.customerQuery.sex,changeInitialPassword:this.customerQuery.changeInitialPassword,uploadPhoto:this.customerQuery.uploadPhoto}}).then(function(e){var o=e.data;0===o.code&&(t.table.tableData=o.data,t.table.tableData.forEach(function(t){null!=t.picUrl&&""!=t.picUrl&&(t.picUrl=t.picUrl+"?"+Math.random())}),t.table.total=o.count)})},handleCurrentChange:function(t){this.table.page=t,this.getCustomers()},handleSizeChange:function(t){this.table.limit=t,this.getCustomers()},handleSelectionChange:function(t){this.multipleSelection=t,this.multipleSelection.length>0?this.disabled=!1:this.disabled=!0},checkSelection:function(){if(this.multipleSelection.length>0)return!0;this.$message.error("请先选择数据")},handleDelete:function(){var t=this;if(this.checkSelection()){var e=this.multipleSelection.length;this.$confirm(" 确定要批量删除这"+e+"个客户信息吗？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var e=[],o=0;o<t.multipleSelection.length;o++)e.push(t.multipleSelection[o].id);t.$axios.delete("/api/backstage/customermanage/"+e.toString()).then(function(e){0===e.data.code&&t.getCustomers()})}).catch(function(t){})}},removeCustomersProfilePicture:function(){var t=this;if(this.checkSelection()){var e=this.multipleSelection.length;this.$confirm(" 确定要批量删除这"+e+"个账户的头像吗？移除后相关照片都将无法恢复！","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var e=[],o=0;o<t.multipleSelection.length;o++)e.push(t.multipleSelection[o].id);t.$axios.delete("/api/backstage/customermanage/customersProfilePicture/"+e.toString()).then(function(e){0===e.data.code&&t.getCustomers()})}).catch(function(t){})}},edit:function(t){this.$refs.customerEditForm.openDialog(t)},uploadPhoto:function(t){this.$refs.customerPhotoUpload.openDialog(t)},resetPassword:function(t){var e=this;this.$confirm("确定重置账户（"+t.username+"）的密码吗？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$axios.patch("/api/backstage/customermanage/resetPassword/"+t.id).then(function(t){var o=t.data;0===o.code?e.getCustomers():e.$message.error(o.msg)}).catch(function(t){console.log(t)})}).catch(function(t){})},search:function(){var t=this.customerQuery.username;this.customerQuery={username:t},this.getCustomers()}},mounted:function(){this.getCustomers()}},a={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"item"},[o("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{model:t.customerQuery,inline:!0}},[o("el-form-item",{attrs:{label:"账户名"}},[o("el-input",{attrs:{placeholder:"账户名"},model:{value:t.customerQuery.username,callback:function(e){t.$set(t.customerQuery,"username",e)},expression:"customerQuery.username"}})],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.customerSearchForm.openDialog()}}},[t._v("高级查询")])],1),t._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.customerQuery={},t.getCustomers()}}},[t._v("清空查询条件")])],1)],1)],1),t._v(" "),o("div",{staticClass:"item",staticStyle:{"margin-bottom":"5px"},attrs:{align:"left"}},[o("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.customerAddForm.openDialog()}}},[t._v("添加")]),t._v(" "),o("el-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:t.handleDelete}},[t._v("删除")]),t._v(" "),o("el-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:t.removeCustomersProfilePicture}},[t._v("移除头像")])],1),t._v(" "),o("div",{staticClass:"item"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.table.tableData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),t._v(" "),o("el-table-column",{attrs:{width:"80",prop:"picUrl",align:"center",label:"头像"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",{staticStyle:{display:"block",height:"30px"}},[null!=e.row.picUrl&&""!=e.row.picUrl?o("el-image",{staticStyle:{height:"30px"},attrs:{fit:"contain",src:e.row.picUrl,"preview-src-list":[e.row.picUrl]}}):o("el-image",{staticStyle:{height:"30px"},attrs:{fit:"contain",src:t.myVariable.pic.noPicSrc}})],1)]}}])}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"username",label:"用户名"}}),t._v(" "),o("el-table-column",{attrs:{width:"85",align:"center",prop:"initialPasswordStatus",label:"密码状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.initialPasswordStatus?o("el-tag",{attrs:{type:"danger"}},[t._v("初始密码")]):t._e(),t._v(" "),0==e.row.initialPasswordStatus?o("el-tag",{attrs:{type:"success"}},[t._v("已变更")]):t._e()]}}])}),t._v(" "),o("el-table-column",{attrs:{width:"70","show-overflow-tooltip":"",prop:"name",label:"姓名"}}),t._v(" "),o("el-table-column",{attrs:{width:"50",align:"center",prop:"sex",label:"性别"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.sex?[t._v("男")]:2==e.row.sex?[t._v("女")]:[t._v("未选择")]]}}])}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"tel",label:"电话"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"address",label:"地址"}}),t._v(" "),o("el-table-column",{attrs:{width:"70","show-overflow-tooltip":"",align:"center",prop:"zip",label:"邮编"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"email",label:"邮箱"}}),t._v(" "),o("el-table-column",{attrs:{width:"60",align:"center","show-overflow-tooltip":"",prop:"productOrderNumber",label:"订单数"}}),t._v(" "),o("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"createTime",label:"注册时间"}}),t._v(" "),o("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"360"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit"},on:{click:function(o){return t.edit(e.row.id)}}},[t._v("编辑")]),t._v(" "),o("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-user"},on:{click:function(o){return t.uploadPhoto(e.row.id)}}},[t._v("上传头像")]),t._v(" "),o("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-user"},on:{click:function(o){return t.resetPassword(e.row)}}},[t._v("重置密码")])]}}])})],1)],1),t._v(" "),o("div",{staticClass:"text item"},[o("div",{staticClass:"block"},[o("el-pagination",{attrs:{background:"",layout:"prev,pager,next,total,sizes,jumper","hide-on-single-page":t.table.hideOnSinglePage,"page-sizes":[10,20,50,100],"page-size":t.table.limit,"current-page":t.table.page,total:t.table.total,"pager-count":11},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),o("CustomerAdd",{ref:"customerAddForm",on:{customerTableRefresh:t.getCustomers}}),t._v(" "),o("CustomerEdit",{ref:"customerEditForm",on:{customerTableRefresh:t.getCustomers}}),t._v(" "),o("CustomerPhotoUpload",{ref:"customerPhotoUpload",on:{customerTableRefresh:t.getCustomers}}),t._v(" "),o("CustomerSearch",{ref:"customerSearchForm",attrs:{customerQuery:t.customerQuery},on:{customerTableRefresh:t.getCustomers}})],1)},staticRenderFns:[]};var n=o("VU/8")(r,a,!1,function(t){o("Wlt1")},"data-v-7a43adbb",null);e.default=n.exports},Wlt1:function(t,e){}});
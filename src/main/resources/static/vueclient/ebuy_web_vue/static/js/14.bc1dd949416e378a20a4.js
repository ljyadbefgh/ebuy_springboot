webpackJsonp([14],{DnS1:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={name:"ProductOrderManage",components:{ProductOrderSearch:function(){return r.e(72).then(r.bind(null,"01Wq"))},ProductOrderDetailManageByProductOrder:function(){return r.e(64).then(r.bind(null,"7K3k"))},ProductOrderEdit:function(){return r.e(45).then(r.bind(null,"sbp1"))}},data:function(){return{disabled:!0,table:{tableData:[],limit:10,page:1,total:0,hideOnSinglePage:!1},productOrder:null,multipleSelection:[],productOrderQuery:{}}},methods:{initQuery:function(){this.$set(this.productOrderQuery,"orderNo",""),this.$set(this.productOrderQuery,"paymentType",""),this.$set(this.productOrderQuery,"paymentStatus",""),this.$set(this.productOrderQuery,"tag",""),this.$set(this.productOrderQuery,"customerId",""),this.$set(this.productOrderQuery,"sendName",""),this.$set(this.productOrderQuery,"createTimeQueryOfBegin",""),this.$set(this.productOrderQuery,"createTimeQueryOfEnd",""),this.$set(this.productOrderQuery,"dealTimeQueryOfBegin",""),this.$set(this.productOrderQuery,"dealTimeQueryOfEnd",""),this.$set(this.productOrderQuery,"sendTimeQueryOfBegin",""),this.$set(this.productOrderQuery,"sendTimeQueryOfEnd",""),this.$set(this.productOrderQuery,"receiveTimeQueryOfBegin",""),this.$set(this.productOrderQuery,"receiveTimeQueryOfEnd","")},clearQuery:function(){this.initQuery()},getTableData:function(){var e=this;this.$axios.get("/api/backstage/productorder",{params:{page:this.table.page,limit:this.table.limit,orderNo:this.productOrderQuery.orderNo,paymentType:this.productOrderQuery.paymentType,paymentStatus:this.productOrderQuery.paymentStatus,tag:this.productOrderQuery.tag,"customer.id":this.productOrderQuery.customerId,sendName:this.productOrderQuery.sendName,createTimeQueryOfBegin:this.productOrderQuery.createTimeQueryOfBegin,createTimeQueryOfEnd:this.productOrderQuery.createTimeQueryOfEnd,dealTimeQueryOfBegin:this.productOrderQuery.dealTimeQueryOfBegin,dealTimeQueryOfEnd:this.productOrderQuery.dealTimeQueryOfEnd,sendTimeQueryOfBegin:this.productOrderQuery.sendTimeQueryOfBegin,sendTimeQueryOfEnd:this.productOrderQuery.sendTimeQueryOfEnd,receiveTimeQueryOfBegin:this.productOrderQuery.receiveTimeQueryOfBegin,receiveTimeQueryOfEnd:this.productOrderQuery.receiveTimeQueryOfEnd}}).then(function(t){var r=t.data;0===r.code&&(e.table.tableData=r.data,e.table.total=r.count)})},handleCurrentChange:function(e){this.table.page=e,this.getTableData()},handleSizeChange:function(e){this.table.limit=e,this.getTableData()},handleSelectionChange:function(e){this.multipleSelection=e,this.multipleSelection.length>0?this.disabled=!1:this.disabled=!0},checkSelection:function(){if(this.multipleSelection.length>0)return!0;this.$message.error("请先选择数据")},operatorProductOrder:function(e,t){"editStrikePrice"==e?this.editStrikePrice(t):"editMerchantShipped"==e?this.editMerchantShipped(t.orderNo):"editPayment"==e?this.editPayment(t.orderNo):"voided"==e?this.voided(t.orderNo):"cancel"==e&&this.cancel(t.orderNo)},editStrikePrice:function(e){var t=this;this.productOrder=e,this.$nextTick(function(){t.$refs.productOrderEdit.openDialog()})},editMerchantShipped:function(e){var t=this;this.$confirm(" 确定要将订单状态改为“已发货”吗？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.patch("/api/backstage/productorder/"+e+"/merchantShipped").then(function(e){0===e.data.code&&t.getTableData()})}).catch(function(e){})},voided:function(e){var t=this;this.$confirm(" 确定要将订单状态改为“作废”吗？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.patch("/api/backstage/productorder/"+e+"/voided").then(function(e){0===e.data.code&&t.getTableData()})}).catch(function(e){})},cancel:function(e){var t=this;this.$confirm(" 是否允许取消该订单吗？取消订单将可能退款给客户","系统提示",{distinguishCancelAndClose:!0,confirmButtonText:"允许",cancelButtonText:"拒绝并恢复订单正常状态",type:"warning"}).then(function(){t.$axios.patch("/api/backstage/productorder/"+e+"/cancel").then(function(e){0===e.data.code&&t.getTableData()})}).catch(function(r){"cancel"===r&&t.$axios.patch("/api/backstage/productorder/"+e+"/rejectCancel").then(function(e){0===e.data.code&&t.getTableData()})})},editPayment:function(e){var t=this;this.$confirm(" 确定要将订单支付状态改为“已支付”吗？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$axios.patch("/api/backstage/productorder/"+e+"/payment").then(function(e){0===e.data.code&&t.getTableData()})}).catch(function(e){})}},mounted:function(){this.initQuery(),this.getTableData()}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"item"},[r("div",{staticClass:"item"},[r("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{model:e.productOrderQuery,inline:!0}},[r("el-form-item",[r("el-input",{attrs:{placeholder:"订单编号"},model:{value:e.productOrderQuery.orderNo,callback:function(t){e.$set(e.productOrderQuery,"orderNo",t)},expression:"productOrderQuery.orderNo"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.getTableData}},[e._v("查询")])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$refs.productOrderSearch.openDialog()}}},[e._v("高级查询")])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.clearQuery(),e.getTableData()}}},[e._v("清空查询条件")])],1)],1)],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.table.tableData,stripe:"",border:""},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("ProductOrderDetailManageByProductOrder",{ref:"roductOrderDetailManage",attrs:{productOrderRow:e.row}})]}}])}),e._v(" "),r("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"orderNo",label:"订单编号"}}),e._v(" "),r("el-table-column",{attrs:{width:"70","show-overflow-tooltip":"",prop:"customer.name",label:"客户"}}),e._v(" "),r("el-table-column",{attrs:{width:"100",align:"center","show-overflow-tooltip":"",prop:"totalPrice",label:"总价"}}),e._v(" "),r("el-table-column",{attrs:{width:"100",align:"center","show-overflow-tooltip":"",prop:"strikePrice",label:"成交价"}}),e._v(" "),r("el-table-column",{attrs:{width:"70","show-overflow-tooltip":"",align:"center",label:"付款方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.paymentType?[e._v("网上支付")]:e._e(),e._v(" "),2==t.row.paymentType?[e._v("货到付款")]:e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"70","show-overflow-tooltip":"",align:"center",label:"支付状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.paymentStatus?r("el-tag",{attrs:{type:"danger"}},[e._v("未付款")]):1==t.row.paymentStatus?r("el-tag",{attrs:{type:"success"}},[e._v("已付款")]):r("el-tag",{attrs:{type:"warning"}},[e._v("已退款")])]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"70","show-overflow-tooltip":"",align:"center",prop:"tag",label:"物流状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.myVariable.orderDeliverStatusMap[t.row.deliverStatus])+"\n        ")]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"70","show-overflow-tooltip":"",align:"center",prop:"tag",label:"订单状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.myVariable.orderTagMap[t.row.tag])+"\n        ")]}}])}),e._v(" "),r("el-table-column",{attrs:{width:"140","show-overflow-tooltip":"",align:"center",prop:"createTime",label:"下单时间"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-dropdown",{attrs:{trigger:"click"},on:{command:function(r){return e.operatorProductOrder(r,t.row)}}},[r("el-button",[e._v("请选择操作"),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),r("el-dropdown-menu",[r("el-dropdown-item",{attrs:{command:"editStrikePrice"}},[e._v("修改订单信息")]),e._v(" "),1==t.row.tag?r("el-dropdown-item",{attrs:{command:"editMerchantShipped"}},[e._v("已发送货物")]):e._e(),e._v(" "),-1==t.row.tag?r("el-dropdown-item",{attrs:{command:"cancel"}},[e._v("取消订单")]):e._e(),e._v(" "),t.row.tag>=0&&t.row.tag<=2?r("el-dropdown-item",{attrs:{command:"voided"}},[e._v("订单作废")]):e._e()],1)],1)]}}])})],1)],1),e._v(" "),r("div",{staticClass:"text item"},[r("div",{staticClass:"block"},[r("el-pagination",{attrs:{background:"",layout:"prev,pager,next,total,sizes,jumper","hide-on-single-page":e.table.hideOnSinglePage,"page-sizes":[10,20,50,100],"page-size":e.table.limit,"current-page":e.table.page,total:e.table.total,"pager-count":11},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),r("ProductOrderEdit",{ref:"productOrderEdit",attrs:{productOrder:e.productOrder}}),e._v(" "),r("ProductOrderSearch",{ref:"productOrderSearch",attrs:{productOrderQuery:e.productOrderQuery},on:{tableRefresh:e.getTableData,clearQuery:e.clearQuery}})],1)},staticRenderFns:[]};var n=r("VU/8")(a,i,!1,function(e){r("mCev")},"data-v-4e5efe16",null);t.default=n.exports},mCev:function(e,t){}});
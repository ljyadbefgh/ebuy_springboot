webpackJsonp([13],{"5LYD":function(e,t){},ZkOp:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("mvHQ"),a=n.n(i),l={name:"AdminManage",components:{AdminAdd:function(){return n.e(65).then(n.bind(null,"juAX"))},AdminEdit:function(){return n.e(59).then(n.bind(null,"QkSz"))},AdminRoleRelationManage:function(){return n.e(68).then(n.bind(null,"YSD9"))},AdminRoleBatchOperation:function(){return n.e(55).then(n.bind(null,"U1HS"))},AdminMenuManage:function(){return n.e(63).then(n.bind(null,"7zCQ"))}},data:function(){var e=this;return{disabled:!0,tableLoading:!1,tableData:[],limit:20,page:1,total:0,hideOnSinglePage:!1,createTimeQueryOfBeginPickerOption:{disabledDate:function(t){if(e.adminQuery.createTimeQueryOfEnd)return t.getTime()>new Date(e.adminQuery.createTimeQueryOfEnd).getTime()-864e5}},createTimeQueryOfEndPickerOption:{disabledDate:function(t){if(e.adminQuery.createTimeQueryOfBegin)return t.getTime()<new Date(e.adminQuery.createTimeQueryOfBegin).getTime()+864e5}},adminQuery:{username:"",name:"",roleIds:[],createTimeQueryOfBegin:"",createTimeQueryOfEnd:""},roles:[],operatorOptions:[{value:"add",label:"添加管理账户"},{value:"remove",label:"批量删除管理账户"},{value:"batchOperatorRoles",label:"批量赋予/取消角色"}],multipleSelection:[]}},methods:{formatSex:function(e,t){return 1==e.sex?"男":"女"},initRoleSelect:function(){var e=this;this.$axios.get("/api/backstage/rolemanage/all").then(function(t){var n=t.data;0===n.code&&(e.roles=n.data)})},getAdminList:function(){var e=this,t=null;null!=this.adminQuery.roleIds&&(t=this.adminQuery.roleIds.toString()),this.tableLoading=!0,this.$axios.get(this.API.API_URL_BACKSTAGE_ADMIN_MANAGE,{params:{page:this.page,limit:this.limit,username:this.adminQuery.username,name:this.adminQuery.name,roleIds:t,createTimeQueryOfBegin:this.adminQuery.createTimeQueryOfBegin,createTimeQueryOfEnd:this.adminQuery.createTimeQueryOfEnd}}).then(function(t){var n=t.data;e.tableLoading=!1,0===n.code&&(e.tableData=n.data,e.total=n.count)}).catch(function(t){e.tableLoading=!1})},handleCurrentChange:function(e){this.page=e,this.getAdminList()},handleSizeChange:function(e){this.limit=e,this.getAdminList()},roleSelect:function(e){this.getAdminList()},search:function(){this.getAdminList()},unLockedChange:function(e,t){var n=this,i={id:t.id,unLocked:e};this.tableLoading=!0,this.$axios.put("/api/backstage/adminmanage",a()(i)).then(function(i){n.tableLoading=!1;var a=i.data;0===a.code?n.$message({type:"success",message:a.msg}):(n.$message.error(a.msg),t.unLocked=!e)}).catch(function(i){n.tableLoading=!1,t.unLocked=!e})},handleSelectionChange:function(e){this.multipleSelection=e,this.multipleSelection.length>0?this.disabled=!1:this.disabled=!0},checkSelection:function(){if(this.multipleSelection&&this.multipleSelection.length)return!0;this.$message.error("请先选择数据")},handleDelete:function(){var e=this;if(this.checkSelection()){var t=this.multipleSelection.length;this.$confirm(" 确定要批量删除这"+t+"个账户吗？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t=[],n=0;n<e.multipleSelection.length;n++)t.push(e.multipleSelection[n].id);e.$axios.delete("/api/backstage/adminmanage/deletes/"+t.toString()).then(function(t){0===t.data.code&&e.getAdminList()})}).catch(function(e){})}},batchOperatorRoles:function(){this.checkSelection()&&this.$refs.AdminRoleBatchOperation.openDialog()},editAdmin:function(e){this.$refs.adminEditForm.openDialog(e)},manageRoles:function(e){this.$refs.AdminRoleRelationManage.openDialog(e.id,e.username)},readMenus:function(e){this.$refs.adminMenuManage.openDialog(e.id)}},mounted:function(){this.initRoleSelect(),this.getAdminList()}},r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"item"},[n("el-form",{staticClass:"demo-form-inline",staticStyle:{"text-align":"left"},attrs:{model:e.adminQuery,inline:!0}},[n("el-form-item",{attrs:{label:"账户名"}},[n("el-input",{attrs:{placeholder:"账户名"},model:{value:e.adminQuery.username,callback:function(t){e.$set(e.adminQuery,"username",t)},expression:"adminQuery.username"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"网名"}},[n("el-input",{attrs:{placeholder:"网名"},model:{value:e.adminQuery.name,callback:function(t){e.$set(e.adminQuery,"name",t)},expression:"adminQuery.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"角色"}},[n("el-select",{attrs:{filterable:"",multiple:"",placeholder:"请选择"},on:{change:e.roleSelect},model:{value:e.adminQuery.roleIds,callback:function(t){e.$set(e.adminQuery,"roleIds",t)},expression:"adminQuery.roleIds"}},e._l(e.roles,function(e){return n("el-option",{key:e.id,attrs:{label:e.nameZH,value:e.id}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"注册时间"}},[n("el-date-picker",{attrs:{"picker-options":e.createTimeQueryOfBeginPickerOption,type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.adminQuery.createTimeQueryOfBegin,callback:function(t){e.$set(e.adminQuery,"createTimeQueryOfBegin",t)},expression:"adminQuery.createTimeQueryOfBegin"}}),e._v("\n        -\n          "),n("el-date-picker",{attrs:{"picker-options":e.createTimeQueryOfEndPickerOption,type:"datetime",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.adminQuery.createTimeQueryOfEnd,callback:function(t){e.$set(e.adminQuery,"createTimeQueryOfEnd",t)},expression:"adminQuery.createTimeQueryOfEnd"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.getAdminList}},[e._v("查询")])],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.adminQuery={},e.getAdminList()}}},[e._v("清空查询条件")])],1)],1)],1),e._v(" "),n("div",{staticClass:"item",staticStyle:{"margin-bottom":"5px"},attrs:{align:"left"}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.$refs.adminAddForm.openDialog()}}},[e._v("添加")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",disabled:e.disabled},on:{click:e.handleDelete}},[e._v("删除")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",disabled:e.disabled},on:{click:e.batchOperatorRoles}},[e._v("角色批量分配")])],1),e._v(" "),n("div",{staticClass:"item"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{"element-loading-text":"表格加载中，请稍后……",data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),e._v(" "),n("el-table-column",{attrs:{prop:"username",label:"账户名"}}),e._v(" "),n("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{width:"50",align:"center",prop:"sex",label:"性别",formatter:e.formatSex}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"roleNumber",label:"角色数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.roleNumber>0?[n("el-popover",{attrs:{placement:"top",effect:"light",trigger:"click"}},[n("el-table",{attrs:{data:t.row.roles}},[n("el-table-column",{attrs:{width:"150",property:"name",label:"角色中文名"}}),e._v(" "),n("el-table-column",{attrs:{width:"150",property:"nameZH",label:"角色英文名"}}),e._v(" "),n("el-table-column",{attrs:{width:"100",property:"level",label:"级别"}})],1),e._v(" "),n("el-link",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[e._v(e._s(t.row.roleNumber))])],1)]:[e._v(e._s(t.row.roleNumber))]]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"menuNumber",label:"菜单数量"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"saveProductNumber",label:"发布产品数"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",prop:"createTime",label:"注册时间",width:"180"}}),e._v(" "),n("el-table-column",{attrs:{prop:"unLocked",label:"是否锁定",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-switch",{attrs:{"inactive-icon-class":"el-icon-lock","active-icon-class":"el-icon-unlock","active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(n){return e.unLockedChange(n,t.row)}},model:{value:t.row.unLocked,callback:function(n){e.$set(t.row,"unLocked",n)},expression:"scope.row.unLocked"}})]}}])}),e._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"330"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-edit"},on:{click:function(n){return e.editAdmin(t.row.id)}}},[e._v("编辑")]),e._v(" "),n("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-user"},on:{click:function(n){return e.manageRoles(t.row)}}},[e._v("角色分配")]),e._v(" "),n("el-button",{attrs:{type:"primary",plain:"",size:"mini",icon:"el-icon-user"},on:{click:function(n){return e.readMenus(t.row)}}},[e._v("菜单预览")])]}}])})],1)],1),e._v(" "),n("div",{staticClass:"text item"},[n("div",{staticClass:"block"},[n("el-pagination",{attrs:{background:"",layout:"prev,pager,next,total,sizes,jumper","hide-on-single-page":e.hideOnSinglePage,"page-sizes":[10,20,50,100],"page-size":e.limit,"current-page":e.page,total:e.total,"pager-count":11},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),n("AdminAdd",{ref:"adminAddForm",attrs:{roles:this.roles},on:{adminTableRefresh:e.getAdminList}}),e._v(" "),n("AdminEdit",{ref:"adminEditForm",attrs:{roles:this.roles},on:{adminTableRefresh:e.getAdminList}}),e._v(" "),n("AdminRoleRelationManage",{ref:"AdminRoleRelationManage",on:{adminTableRefresh:e.getAdminList}}),e._v(" "),n("AdminRoleBatchOperation",{ref:"AdminRoleBatchOperation",attrs:{adminRows:this.multipleSelection,roles:this.roles},on:{adminTableRefresh:e.getAdminList}}),e._v(" "),n("AdminMenuManage",{ref:"adminMenuManage"})],1)},staticRenderFns:[]};var o=n("VU/8")(l,r,!1,function(e){n("5LYD")},"data-v-54f99c90",null);t.default=o.exports}});
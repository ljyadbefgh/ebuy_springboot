webpackJsonp([6],{gnon:function(t,e){},opuo:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("//Fk"),l=a.n(r),n={name:"ProductManage",components:{ProductSearch:function(){return a.e(71).then(a.bind(null,"kiNw"))},ProductAdd:function(){return a.e(40).then(a.bind(null,"9A5t"))},ProductEdit:function(){return a.e(35).then(a.bind(null,"Qz3x"))},ProductTransfer:function(){return a.e(39).then(a.bind(null,"WkUo"))}},data:function(){return{disabled:!0,table:{tableData:[],limit:10,page:1,total:0,hideOnSinglePage:!1},multipleSelection:[],productQuery:{name:null,onSale:null,productTypeId:"",orderNum:null,orderType:null},orderNumOptions:[]}},methods:{clearQuery:function(){this.productQuery={}},getOrderNums:function(){var t=this;this.$axios.get("/api/backstage/product/orderNumMap").then(function(e){var a=e.data;0===a.code&&(t.orderNumOptions=a.data)})},getTableData:function(){var t=this;this.$axios.get("/api/backstage/product",{params:{page:this.table.page,limit:this.table.limit,name:this.productQuery.name,onSale:this.productQuery.onSale,"productType.id":this.productQuery.productTypeId,orderNum:this.productQuery.orderNum,orderType:this.productQuery.orderType}}).then(function(e){var a=e.data;0===a.code&&(t.table.tableData=a.data,t.table.tableData.forEach(function(t){null!=t.picUrl&&""!=t.picUrl&&(t.picUrl=t.picUrl+"?"+Math.random())}),t.table.total=a.count)})},handleCurrentChange:function(t){this.table.page=t,this.getTableData()},handleSizeChange:function(t){this.table.limit=t,this.getTableData()},handleSelectionChange:function(t){this.multipleSelection=t,this.multipleSelection.length>0?this.disabled=!1:this.disabled=!0},checkSelection:function(){if(this.multipleSelection.length>0)return!0;this.$message.error("请先选择数据")},handleDelete:function(){var t=this;if(this.checkSelection()){var e=this.multipleSelection.length;this.$confirm(" 确定要批量删除这"+e+"个产品信息吗？","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var e=[],a=0;a<t.multipleSelection.length;a++)e.push(t.multipleSelection[a].id);t.$axios.delete("/api/backstage/product/"+e.toString()).then(function(e){0===e.data.code&&t.getTableData()})}).catch(function(t){})}},edit:function(t){var e=this;this.$nextTick(function(){e.$refs.customerEditForm.openDialog(t)})},uploadPhoto:function(t){this.$refs.customerPhotoUpload.openDialog(t)}},created:function(){var t=this;this.myMethod.promise.queuePromiseOfResolve([function(){return new l.a(function(e,a){t.getOrderNums(),e()})},function(){return new l.a(function(e,a){t.getTableData(),e()})}])}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"item"},[a("ProductSearch",{ref:"productSearch",attrs:{productQuery:t.productQuery,orderNumOptions:t.orderNumOptions},on:{tableRefresh:t.getTableData,clearQuery:t.clearQuery}})],1),t._v(" "),a("div",{staticClass:"item",staticStyle:{"margin-bottom":"5px"},attrs:{align:"left"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$refs.productAddForm.openDialog()}}},[t._v("添加")]),t._v(" "),a("el-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:t.handleDelete}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){return t.$refs.productTransfer.openDialog()}}},[t._v("批量转移产品")])],1),t._v(" "),a("div",{staticClass:"item"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.table.tableData,stripe:"",border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"40",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{width:"80",align:"center",label:"产品图片"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{display:"block",height:"30px"}},[null!=e.row.picUrl&&""!=e.row.picUrl?a("el-image",{staticStyle:{height:"30px"},attrs:{fit:"contain",src:e.row.picUrl,"preview-src-list":[e.row.picUrl]}}):a("el-image",{staticStyle:{height:"30px"},attrs:{fit:"contain",src:t.myVariable.pic.noPic4Src}})],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"name",label:"名称"}}),t._v(" "),a("el-table-column",{attrs:{width:"100","show-overflow-tooltip":"",prop:"productType.name",label:"所属栏目"}}),t._v(" "),a("el-table-column",{attrs:{width:"60",align:"center",prop:"orderNum",label:"优先级"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.orderNumOptions[e.row.orderNum])+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"60",align:"center",label:"预览图"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n         "+t._s(e.row.previewPictures.length)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"80",align:"center",prop:"price",label:"现价"}}),t._v(" "),a("el-table-column",{attrs:{width:"80",align:"center",prop:"originalPrice",label:"原价"}}),t._v(" "),a("el-table-column",{attrs:{width:"80",align:"center",prop:"repository",label:"库存"}}),t._v(" "),a("el-table-column",{attrs:{width:"80",align:"center",prop:"click",label:"人气"}}),t._v(" "),a("el-table-column",{attrs:{width:"80",align:"center",prop:"recommendation",label:"推荐指数"}}),t._v(" "),a("el-table-column",{attrs:{width:"80",align:"center",prop:"productOrderDetailNumber",label:"订单数"}}),t._v(" "),a("el-table-column",{attrs:{width:"80",align:"center",prop:"salesVolume",label:"销量"}}),t._v(" "),a("el-table-column",{attrs:{width:"70",align:"center",prop:"onSale",label:"是否上架"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.onSale?a("el-tag",{attrs:{type:"success"}},[t._v("上架")]):a("el-tag",{attrs:{type:"danger"}},[t._v("下架")])]}}])}),t._v(" "),a("el-table-column",{attrs:{width:"80","show-overflow-tooltip":"",prop:"creator.username",label:"发布人"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"100",align:"center",prop:"createTime",label:"发布时间"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":"",width:"100",align:"center",prop:"updateTime",label:"最后编辑时间"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit"},on:{click:function(a){return t.$refs.productEditForm.openDialog(e.row.id)}}},[t._v("编辑")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"text item"},[a("div",{staticClass:"block"},[a("el-pagination",{attrs:{background:"",layout:"prev,pager,next,total,sizes,jumper","hide-on-single-page":t.table.hideOnSinglePage,"page-sizes":[10,20,50,100],"page-size":t.table.limit,"current-page":t.table.page,total:t.table.total,"pager-count":11},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),a("ProductAdd",{ref:"productAddForm",attrs:{orderNumOptions:t.orderNumOptions},on:{tableRefresh:t.getTableData}}),t._v(" "),a("ProductEdit",{ref:"productEditForm",attrs:{orderNumOptions:t.orderNumOptions},on:{tableRefresh:t.getTableData}}),t._v(" "),a("ProductTransfer",{ref:"productTransfer",attrs:{products:t.multipleSelection},on:{tableRefresh:t.getTableData}})],1)},staticRenderFns:[]};var i=a("VU/8")(n,o,!1,function(t){a("gnon")},"data-v-c36cdc36",null);e.default=i.exports}});